<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Limpiar LocalStorage - Zogen</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        button {
            background: #9B7CB8;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: background 0.2s;
        }
        button:hover {
            background: #8A6BA7;
        }
        button.danger {
            background: #dc3545;
        }
        button.danger:hover {
            background: #c82333;
        }
        button.secondary {
            background: #6c757d;
        }
        button.secondary:hover {
            background: #5a6268;
        }
        .info {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            color: #155724;
        }
        .storage-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .key-item {
            padding: 8px;
            margin: 5px 0;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .key-name {
            font-family: monospace;
            color: #495057;
        }
        .btn-group {
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßπ Limpiar LocalStorage - Zogen</h1>
        <p class="subtitle">Herramienta para limpiar datos de prueba del navegador</p>

        <div class="info">
            <strong>‚ÑπÔ∏è Informaci√≥n:</strong> Esta herramienta te ayuda a limpiar los datos almacenados localmente en tu navegador para hacer pruebas frescas.
        </div>

        <div class="storage-info">
            <h3>üìä Estado actual del LocalStorage:</h3>
            <div id="storageKeys">Cargando...</div>
            <p><strong>Total de elementos:</strong> <span id="totalKeys">0</span></p>
        </div>

        <div class="btn-group">
            <h3>üéØ Opciones de limpieza:</h3>
            <button onclick="clearSolicitudes()">Limpiar Solicitudes</button>
            <button onclick="clearAdminData()">Limpiar Datos de Administraci√≥n</button>
            <button onclick="clearPatientData()">Limpiar Datos de Pacientes</button>
            <button onclick="clearFiles()">Limpiar Archivos</button>
            <button onclick="clearCotizaciones()">Limpiar Cotizaciones</button>
            <button onclick="clearVTRequests()">Limpiar Solicitudes VT</button>
            <button class="secondary" onclick="clearAuth()">Cerrar Sesi√≥n (mantener datos)</button>
            <br><br>
            <button class="danger" onclick="clearAll()">üóëÔ∏è Limpiar TODO</button>
            <button class="secondary" onclick="refreshInfo()">üîÑ Actualizar Info</button>
        </div>

        <div id="result"></div>
    </div>

    <script>
        function showResult(message, type = 'success') {
            const resultDiv = document.getElementById('result');
            resultDiv.className = type;
            resultDiv.innerHTML = message;
            refreshInfo();
            setTimeout(() => {
                resultDiv.innerHTML = '';
                resultDiv.className = '';
            }, 3000);
        }

        function refreshInfo() {
            const keys = Object.keys(localStorage);
            const keysDiv = document.getElementById('storageKeys');
            const totalKeysSpan = document.getElementById('totalKeys');

            totalKeysSpan.textContent = keys.length;

            if (keys.length === 0) {
                keysDiv.innerHTML = '<p style="color: #6c757d;">No hay datos almacenados</p>';
            } else {
                const grouped = {
                    'solicitudes': [],
                    'admin': [],
                    'patient': [],
                    'files': [],
                    'cotizacion': [],
                    'vt': [],
                    'otros': []
                };

                keys.forEach(key => {
                    if (key === 'zogen-solicitudes') grouped.solicitudes.push(key);
                    else if (key.startsWith('admin-solicitud-')) grouped.admin.push(key);
                    else if (key.startsWith('patient-data-')) grouped.patient.push(key);
                    else if (key.startsWith('files-')) grouped.files.push(key);
                    else if (key.startsWith('cotizacion-')) grouped.cotizacion.push(key);
                    else if (key.startsWith('vt-request-')) grouped.vt.push(key);
                    else if (key.startsWith('service-data-')) grouped.otros.push(key);
                    else grouped.otros.push(key);
                });

                let html = '';
                Object.entries(grouped).forEach(([category, items]) => {
                    if (items.length > 0) {
                        html += `<p><strong>${category}:</strong> ${items.length} items</p>`;
                    }
                });
                keysDiv.innerHTML = html;
            }
        }

        function clearSolicitudes() {
            localStorage.removeItem('zogen-solicitudes');
            showResult('‚úÖ Solicitudes eliminadas correctamente');
        }

        function clearAdminData() {
            const keys = Object.keys(localStorage).filter(k => k.startsWith('admin-solicitud-'));
            keys.forEach(k => localStorage.removeItem(k));
            showResult(`‚úÖ ${keys.length} datos de administraci√≥n eliminados`);
        }

        function clearPatientData() {
            const keys = Object.keys(localStorage).filter(k => k.startsWith('patient-data-'));
            keys.forEach(k => localStorage.removeItem(k));
            showResult(`‚úÖ ${keys.length} datos de pacientes eliminados`);
        }

        function clearFiles() {
            const keys = Object.keys(localStorage).filter(k => k.startsWith('files-'));
            keys.forEach(k => localStorage.removeItem(k));
            showResult(`‚úÖ ${keys.length} archivos eliminados`);
        }

        function clearCotizaciones() {
            const keys = Object.keys(localStorage).filter(k => k.startsWith('cotizacion-'));
            keys.forEach(k => localStorage.removeItem(k));
            showResult(`‚úÖ ${keys.length} cotizaciones eliminadas`);
        }

        function clearVTRequests() {
            const keys = Object.keys(localStorage).filter(k => k.startsWith('vt-request-'));
            keys.forEach(k => localStorage.removeItem(k));
            showResult(`‚úÖ ${keys.length} solicitudes VT eliminadas`);
        }

        function clearAuth() {
            localStorage.removeItem('zogen-authenticated');
            showResult('‚úÖ Sesi√≥n cerrada. Los datos se mantuvieron.');
        }

        function clearAll() {
            if (confirm('‚ö†Ô∏è ¬øEst√°s seguro de que deseas eliminar TODOS los datos? Esta acci√≥n no se puede deshacer.')) {
                const count = localStorage.length;
                localStorage.clear();
                showResult(`‚úÖ Todos los datos eliminados (${count} items)`);
            }
        }

        // Cargar info al inicio
        refreshInfo();
    </script>
</body>
</html>
